<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Растеризация отрезков и окружностей</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app-shell">
      <header class="app-header">
        <div>
          <h1>Растеризация отрезков и окружностей</h1>
          <p>Пошаговый алгоритм, ЦДА, Брезенхем (отрезок и окружность)</p>
        </div>
      </header>

      <main class="app-main">
        <section class="controls-panel">
          <div class="control-card">
            <h2>Параметры отрезка</h2>
            <div class="field-grid">
              <label>
                x<sub>0</sub>
                <input type="number" id="x0" value="2" />
              </label>
              <label>
                y<sub>0</sub>
                <input type="number" id="y0" value="1" />
              </label>
              <label>
                x<sub>1</sub>
                <input type="number" id="x1" value="10" />
              </label>
              <label>
                y<sub>1</sub>
                <input type="number" id="y1" value="6" />
              </label>
            </div>

            <label class="full-width">
              Алгоритм для отрезка
              <select id="lineAlgorithm">
                <option value="step">Пошаговый (по уравнению прямой)</option>
                <option value="dda">ЦДА (Digital Differential Analyzer)</option>
                <option value="bresenham">Брезенхем (отрезок)</option>
              </select>
            </label>

            <div class="buttons-row">
              <button type="button" id="drawLineBtn" class="btn-primary">
                Нарисовать отрезок
              </button>
              <button type="button" id="exampleLineBtn" class="btn-secondary">
                Пример для Брезенхема
              </button>
            </div>

            <div class="time-row">
              Время выполнения: <span id="lineTime">–</span>
            </div>
          </div>

          <div class="control-card">
            <h2>Параметры окружности</h2>
            <div class="field-grid">
              <label>
                x<sub>c</sub>
                <input type="number" id="xc" value="0" />
              </label>
              <label>
                y<sub>c</sub>
                <input type="number" id="yc" value="0" />
              </label>
              <label>
                r
                <input type="number" id="radius" value="5" min="1" />
              </label>
            </div>

            <p class="hint">Для окружности используется алгоритм Брезенхема.</p>

            <div class="buttons-row">
              <button type="button" id="drawCircleBtn" class="btn-primary">
                Нарисовать окружность
              </button>
            </div>

            <div class="time-row">
              Время выполнения: <span id="circleTime">–</span>
            </div>
          </div>

          <div class="global-clear-row">
            <button
              type="button"
              id="clearBtn"
              class="btn-ghost btn-full-width"
            >
              Очистить холст
            </button>
          </div>

          <div class="legend-card">
            <h3>Обозначения</h3>
            <ul>
              <li>
                <span class="legend-color legend-step"></span> Пошаговый
                алгоритм
              </li>
              <li><span class="legend-color legend-dda"></span> ЦДА</li>
              <li>
                <span class="legend-color legend-bres"></span> Брезенхем
                (отрезок)
              </li>
              <li>
                <span class="legend-color legend-circle"></span> Брезенхем
                (окружность)
              </li>
            </ul>
          </div>
        </section>

        <section class="canvas-panel">
          <canvas id="rasterCanvas" width="650" height="650"></canvas>
        </section>
      </main>

      <details class="info-wrapper">
        <summary>Показать пример вычислений</summary>

        <section class="info-panel">
          <h2>Пример вычислений для алгоритма Брезенхема (отрезок)</h2>
          <p>
            Рассмотрим отрезок от точки <strong>(2, 1)</strong> до
            <strong>(10, 6)</strong>. Здесь dx = 8, dy = 5, наклон меньше 1,
            поэтому основной осью берём x.
          </p>
          <p>Начальное значение параметра:</p>
          <p><code>d₀ = 2·dy − dx = 2·5 − 8 = 2</code></p>

          <p>На каждом шаге:</p>
          <ul>
            <li>
              если dᵢ &gt; 0 — берём пиксель (x+1, y+1) и d<sub>i+1</sub> = dᵢ +
              2(dy − dx);
            </li>
            <li>
              если dᵢ ≤ 0 — берём пиксель (x+1, y) и d<sub>i+1</sub> = dᵢ +
              2·dy.
            </li>
          </ul>

          <table class="calc-table">
            <thead>
              <tr>
                <th>Шаг i</th>
                <th>(xᵢ, yᵢ)</th>
                <th>dᵢ</th>
                <th>Решение</th>
                <th>(xᵢ₊₁, yᵢ₊₁)</th>
                <th>dᵢ₊₁</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>0</td>
                <td>(2, 1)</td>
                <td>2</td>
                <td>d &gt; 0 ⇒ берём (x+1, y+1)</td>
                <td>(3, 2)</td>
                <td>−4</td>
              </tr>
              <tr>
                <td>1</td>
                <td>(3, 2)</td>
                <td>−4</td>
                <td>d ≤ 0 ⇒ берём (x+1, y)</td>
                <td>(4, 2)</td>
                <td>6</td>
              </tr>
              <tr>
                <td>2</td>
                <td>(4, 2)</td>
                <td>6</td>
                <td>d &gt; 0 ⇒ берём (x+1, y+1)</td>
                <td>(5, 3)</td>
                <td>0</td>
              </tr>
              <tr>
                <td>3</td>
                <td>(5, 3)</td>
                <td>0</td>
                <td>d ≤ 0 ⇒ берём (x+1, y)</td>
                <td>(6, 3)</td>
                <td>10</td>
              </tr>
              <tr>
                <td>4</td>
                <td>(6, 3)</td>
                <td>10</td>
                <td>d &gt; 0 ⇒ берём (x+1, y+1)</td>
                <td>(7, 4)</td>
                <td>4</td>
              </tr>
              <tr>
                <td>5</td>
                <td>(7, 4)</td>
                <td>4</td>
                <td>d &gt; 0 ⇒ берём (x+1, y+1)</td>
                <td>(8, 5)</td>
                <td>−2</td>
              </tr>
              <tr>
                <td>6</td>
                <td>(8, 5)</td>
                <td>−2</td>
                <td>d ≤ 0 ⇒ берём (x+1, y)</td>
                <td>(9, 5)</td>
                <td>8</td>
              </tr>
              <tr>
                <td>7</td>
                <td>(9, 5)</td>
                <td>8</td>
                <td>d &gt; 0 ⇒ берём (x+1, y+1)</td>
                <td>(10, 6)</td>
                <td>2</td>
              </tr>
            </tbody>
          </table>

          <p>
            В итоге набор пикселей, который рисует алгоритм: <br />
            (2, 1), (3, 2), (4, 2), (5, 3), (6, 3), (7, 4), (8, 5), (9, 5), (10,
            6).
          </p>
          <p>
            Если в блоке «Параметры отрезка» нажать кнопку
            <strong>«Пример для Брезенхема»</strong>, координаты подставятся
            автоматически, и на холсте можно визуально сравнить точки с этой
            таблицей.
          </p>
        </section>
      </details>
    </div>

    <script src="script.js" defer></script>
  </body>
</html>
